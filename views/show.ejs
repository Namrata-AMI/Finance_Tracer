<%- layout("/layouts/boilerplate") %>

<div class="container mt-1 mb-5">
    <div class="card" style="box-shadow: 12px 15px 15px #D4F3B7;">
        <div class="card-body d-flex" style="justify-content:space-between;">
            <h1 class="text-center">All Transactions</h1>
        </div>
    </div>

    <div class="card mt-3">
        <div class="card-body d-flex">

            <!-- Left  -->
            <div class="left" style="width: 60%;">
                <h3 class="walhead">My Wallet</h3>
                <img src="/assets/img.jpg" class="walletimg m-1">
                <ul class="list-group mt-3">
                    <% allTransactions.forEach(function(transaction) { %>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong style="color:darkcyan;"><%= transaction.description %></strong><br>
                                Amount: ₹<%= transaction.amount %> | <br>
                                Date: <%= transaction.date %>
                            </div>
                            <a href="/edit/<%= transaction._id %>" class="btn btn-warning btn-sm">Edit</a>
                        </li>
                    <% }) %>
                </ul>
            </div>

            <!-- Right -->
            <div class="right mt-5" style="width: 35%; margin-left: 20px;padding: 1rem; border-radius: 8px;">
                <h3>Total Expenses</h3>
                <h4>₹<%= allTransactions.reduce((sum, transaction) => sum + (transaction.type === 'Credit' ? transaction.amount : -transaction.amount), 0) %></h4>
                <hr>

            
                <div class="container mt-5">
                    <h1 class="text-center m-4">Monthly Expenses</h1>
                    <canvas id="expensesChart"></canvas>
                </div>

                <div class="mt-5">
                    <a href="/chart">category wise chart</a>
                </div>
            </div>
           
        </div>
       
    </div>
    
</div>


<script>
    const ctx = document.getElementById('expensesChart').getContext('2d');
    const expensesChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: <%- JSON.stringify(labels) %>,
            datasets: [{
                label: 'Monthly Expenses',
                data: <%- JSON.stringify(data) %>,
                borderColor: 'rgba(75, 192, 192, 1)',
                backgroundColor: '#D4F3B7',
                fill: true,
                tension: 0.4
            }]
        },
        options: {
            animations: {
                tension: {
                    duration: 1000,
                    easing: 'linear',
                    from: 1,
                    to: 0,
                    loop: true
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
</script>


